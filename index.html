<!doctypehtml><html lang="en"><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1"name="viewport"><title>String Notes Ear Training</title><link href="https://cdnjs.cloudflare.com/ajax/libs/press-start-2p/1.0.0/index.min.css"rel="stylesheet"><style>body{margin:0;padding:0;background-color:#000;display:flex;justify-content:center;align-items:center;min-height:100vh;font-family:"Press Start 2P",monospace}.app-container{position:relative;display:flex;flex-direction:column;align-items:center}canvas{display:block}#waveformCanvas{margin-bottom:4px}#noteGuessInput{position:absolute;left:400px;top:160px;z-index:10;opacity:0}.play-button{position:absolute;top:240px;left:40px;width:180px;height:40px;background-color:#6d87bf;border-radius:50%;display:flex;justify-content:center;align-items:center;cursor:pointer;border:none;outline:0;box-shadow:0 4px 4px rgba(0,0,0,.25)}.play-button:hover{background-color:#869ece}.play-button:active{background-color:#4a5e86}.play-button::before{content:"";display:block;width:0;height:0;border-style:solid;border-width:10px 0 10px 17.3px;border-color:transparent transparent transparent #fff;position:relative;left:5px}.answer-display{position:absolute;top:220px;left:400px;font-size:16px;color:#fff;text-align:center}</style><div class="app-container"><canvas height="180"id="waveformCanvas"width="600"></canvas><canvas height="400"id="uiCanvas"width="600"></canvas><input autocomplete="off"id="noteGuessInput"><div class="answer-display"id="answerDisplay"></div></div><script>document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("waveformCanvas"),e=document.getElementById("uiCanvas"),n=document.getElementById("noteGuessInput"),l=document.getElementById("answerDisplay");let o=null,i="",r=null,f=!1,s="C3",a="G5",u=!1,c=0,d={},p=!1,m=null,P=!1,x=null,g=null;const y={background:"#504b6c",panel:"#625f7d",panelBorder:"#2d2d3a",waveformBg:"#263045",waveform:"#8bd1ff",centerline:"#ffffff",buttonNormal:"#6d87bf",buttonHover:"#869ece",buttonPressed:"#4a5e86",buttonText:"#ffffff",inputBg:"#3c3a56",inputBorder:"#7887ad",inputBorderWrong:"#ff6b6b",inputBorderCorrect:"#6bff9e",labelText:"#e0e0e0"};function h(t){const e=t.slice(0,-1),n=parseInt(t.slice(-1));let l=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(e.toUpperCase());return-1===l?null:440*Math.pow(2,n-4+(l-9)/12)}function T(){const t=function(){const t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],e=s.slice(0,-1).toUpperCase(),n=parseInt(s.slice(-1)),l=a.slice(0,-1).toUpperCase(),o=parseInt(a.slice(-1));let i=t.indexOf(e),r=t.indexOf(l);if(-1===i||-1===r)return console.error("Invalid minNote or maxNote"),null;let f=[];for(let e=n;e<=o;e++){let l=e===n?i:0,s=e===o?r+1:t.length;for(let n=l;n<s;n++)f.push(`${t[n]}${e}`)}return 0===f.length?(console.error("No possible notes within the specified range"),null):f[Math.floor(Math.random()*f.length)]}();t?(o=t,i="",n.value="",r=null,f=!1,P=!1,l.textContent="",x?w(h(t)):S()):console.error("Failed to generate a valid note.")}function S(){const e=t;if(!e)return;const n=e.getContext("2d"),l=e.width,o=e.height;n.fillStyle=y.waveformBg,n.fillRect(0,0,l,o);n.fillStyle=y.centerline;for(let t=0;t<l;t+=4)n.fillRect(t,o/2,2,2);d.waveformPoints&&v(n,d.waveformPoints,2,y.panelBorder)}function w(e){const n=t;if(!n)return;const l=n.getContext("2d"),o=n.width,i=n.height;l.fillStyle=y.waveformBg,l.fillRect(0,0,o,i);l.fillStyle=y.centerline;for(let t=0;t<o;t+=4)l.fillRect(t,i/2,2,2);l.fillStyle=y.waveform;const r=i/3,f=e?1e3/e*10:20,s=2*c;for(let t=0;t<o;t+=2){const e=(Math.sin((t+s)/f*Math.PI*2)+.3*Math.sin((t+s)/(f/2)*Math.PI*2)+.15*Math.sin((t+s)/(f/3)*Math.PI*2))*r,n=2*Math.round((i/2+e)/2);l.fillRect(t,n,2,2)}d.waveformPoints&&v(l,d.waveformPoints,2,y.panelBorder)}function B(){const t=(t,e,n,l,o)=>{const i=[];for(let l=0;l<=n;l+=8){const n=Math.random()*o-o/2;i.push({x:t+l,y:e+n})}for(let r=0;r<=l;r+=8){const l=Math.random()*o-o/2;i.push({x:t+n+l,y:e+r})}for(let r=n;r>=0;r-=8){const n=Math.random()*o-o/2;i.push({x:t+r,y:e+l+n})}for(let n=l;n>=0;n-=8){const l=Math.random()*o-o/2;i.push({x:t+l,y:e+n})}return i};return{panelPoints:t(20,60,560,320,4),waveformPoints:t(0,0,600,180,3),inputPanelPoints:t(380,120,180,140,3),guessButtonPoints:t(400,180,140,30,2),newButtonPoints:t(210,330,180,40,2),guessFieldPoints:t(400,120,140,40,2),minFieldPoints:t(90,105,80,30,2),maxFieldPoints:t(90,145,80,30,2),playTrianglePoints:(e=210,n=280,l=20,o=3,[{x:e-l/2,y:n-l/2},{x:e-l/2,y:n+l/2},{x:e+l/2,y:n}].map((t=>({x:t.x+(Math.random()*o-o/2),y:t.y+(Math.random()*o-o/2)})))),answerButtonPoints:t(240,260,120,40,2)};var e,n,l,o}function v(t,e,n,l){if(e&&0!==e.length){t.fillStyle=l;for(let l=0;l<e.length;l++){const o=e[l],i=e[(l+1)%e.length],r=i.x-o.x,f=i.y-o.y,s=Math.sqrt(r*r+f*f),a=Math.ceil(s/n),u=r/a,c=f/a;for(let e=0;e<a;e++){const l=Math.round(o.x+u*e),i=Math.round(o.y+c*e);t.fillRect(l,i,n,n)}}}}function b(){if(!i||!o)return;i.toUpperCase()===o.toUpperCase()?(r=!0,setTimeout((()=>{T()}),1e3)):(f=!0,r=!1,setTimeout((()=>{f=!1}),500))}let R;e.addEventListener("click",(function(t){const i=e;if(!i)return;const r=i.getBoundingClientRect(),f=(t.clientX-r.left)*(i.width/r.width),c=(t.clientY-r.top)*(i.height/r.height),d=(i.width-180)/2,y=i.height-70;if(f>=d&&f<=d+180&&c>=y&&c<=y+40)return m="new",setTimeout((()=>m=null),200),void T();const S=i.width-220+20;if(f>=S&&f<=S+140&&c>=220&&c<=250)return m="guess",setTimeout((()=>m=null),200),void b();if(f>=S&&f<=S+140&&c>=160&&c<=200)return n.focus(),void(p=!0);if(f>=90&&f<=170&&c>=105&&c<=135){const t=prompt("Enter min note (e.g. C3):",s);return void(null!==t&&(s=t))}if(f>=90&&f<=170&&c>=145&&c<=175){const t=prompt("Enter max note (e.g. G5):",a);return void(null!==t&&(a=t))}if(f>=190&&f<=230&&c>=260&&c<=300)return m="play",setTimeout((()=>{m=null}),100),void function(){if(!o)return;x||(x=new(window.AudioContext||window.webkitAudioContext)),g&&g.stop();const t=h(o);if(!t)return;const e=x,n=e.createOscillator(),l=e.createGain();n.type="sine",n.frequency.value=t,l.gain.setValueAtTime(0,e.currentTime),l.gain.linearRampToValueAtTime(.3,e.currentTime+.05),l.gain.linearRampToValueAtTime(.2,e.currentTime+.6),l.gain.linearRampToValueAtTime(0,e.currentTime+2),n.connect(l),l.connect(e.destination),n.start(),n.stop(e.currentTime+2),g=n,u=!0,m="play",setTimeout((()=>{u=!1,m=null}),2e3),w(t)}();if(f>=240&&f<=360&&c>=260&&c<=300)return m="answer",setTimeout((()=>{m=null}),100),P=!0,void(l.textContent=`Answer: ${o}`);p=!1})),n.addEventListener("input",(function(t){i=t.target.value})),n.addEventListener("keypress",(function(t){"Enter"===t.key&&(b(),t.target.blur())})),n.addEventListener("focus",(function(){p=!0})),n.addEventListener("blur",(function(){p=!1})),d=B(),S(),T(),function t(){c=(c+1)%600,c%10==0&&(d=B()),function(){const t=e;if(!t)return;const n=t.getContext("2d");n.imageSmoothingEnabled=!1;const l=t.width,u=t.height;n.fillStyle=y.background,n.fillRect(0,0,l,u),n.font='24px "Press Start 2P", monospace',n.fillStyle="#ffffff",n.textAlign="center",n.textBaseline="middle",n.fillText("STRING NOTES EAR TRAINING",l/2,30),n.fillStyle=y.panel,n.fillRect(20,60,l-40,u-80),d.panelPoints&&v(n,d.panelPoints,3,y.panelBorder);const c=l-220;n.fillStyle=y.panel,n.fillRect(c,120,180,140),d.inputPanelPoints&&v(n,d.inputPanelPoints,2,y.panelBorder);const x=c+20,g=160,h=140;let T=y.inputBorder;f?T=y.inputBorderWrong:r&&(T=y.inputBorderCorrect),n.fillStyle=y.inputBg,n.fillRect(x,g,h,40),d.guessFieldPoints&&v(n,d.guessFieldPoints,2,T),n.font='16px "Press Start 2P", monospace',n.fillStyle="#ffffff",n.textAlign="center",n.textBaseline="middle";const S=p?i+"â–‹":i||"TYPE NOTE";n.fillText(S,x+70,180);const w=x,B=220;if(n.fillStyle="guess"===m?y.buttonPressed:y.buttonNormal,n.fillRect(w,B,140,30),n.fillStyle="#ffffff",n.fillText("GUESS",w+70,235),n.font='14px "Press Start 2P", monospace',n.fillStyle=y.labelText,n.fillText("YOUR GUESS:",x+70,145),!0===r?(n.font='16px "Press Start 2P", monospace',n.fillStyle="#6bff9e",n.fillText("CORRECT!",x+70,275)):!1===r&&(n.font='16px "Press Start 2P", monospace',n.fillStyle="#ff6b6b",n.fillText("TRY AGAIN!",x+70,275)),n.fillStyle="play"===m?y.buttonPressed:y.buttonNormal,n.fillRect(190,260,40,40),d.playTrianglePoints){n.fillStyle="#ffffff",n.beginPath(),n.moveTo(d.playTrianglePoints[0].x,d.playTrianglePoints[0].y);for(let t=1;t<d.playTrianglePoints.length;t++)n.lineTo(d.playTrianglePoints[t].x,d.playTrianglePoints[t].y);n.closePath(),n.fill(),v(n,d.playTrianglePoints,2,"#2d2d3a")}const b=(l-180)/2,R=u-70;n.fillStyle="new"===m?y.buttonPressed:y.buttonNormal,n.fillRect(b,R,180,40),d.newButtonPoints&&v(n,d.newButtonPoints,2,y.panelBorder),n.font='16px "Press Start 2P", monospace',n.fillStyle="#ffffff",n.fillText("NEW NOTE",b+90,R+20);const A=120;n.font='14px "Press Start 2P", monospace',n.fillStyle=y.labelText,n.textAlign="left",n.fillText("MIN:",40,A),n.fillStyle=y.inputBg,n.fillRect(90,105,80,30),d.minFieldPoints&&v(n,d.minFieldPoints,2,y.inputBorder),n.font='14px "Press Start 2P", monospace',n.fillStyle="#ffffff",n.textAlign="center",n.fillText(s,130,A),n.fillStyle=y.labelText,n.textAlign="left",n.fillText("MAX:",40,160),n.fillStyle=y.inputBg,n.fillRect(90,145,80,30),d.maxFieldPoints&&v(n,d.maxFieldPoints,2,y.inputBorder),n.fillStyle="answer"===m?y.buttonPressed:"#6d87bf",n.fillRect(240,260,120,40),d.answerButtonPoints&&v(n,d.answerButtonPoints,2,y.panelBorder),n.font='14px "Press Start 2P", monospace',n.fillStyle="#ffffff",n.textAlign="center",n.textBaseline="middle",n.fillText("SHOW ANSWER",300,280),P&&(n.font='16px "Press Start 2P", monospace',n.fillStyle="#6bff9e",n.textAlign="center",n.fillText(`ANSWER: ${o}`,300,325)),n.font='14px "Press Start 2P", monospace',n.fillStyle="#ffffff",n.textAlign="center",n.fillText(a,130,160)}(),u&&w(h(o)),R=requestAnimationFrame(t)}(),window.addEventListener("unload",(function(){cancelAnimationFrame(R),g&&g.stop(),x&&x.close()}))}));</script>
